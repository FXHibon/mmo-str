<!DOCTYPE html>
<html>
<head>
    <title>MMO Fight</title>
    <meta name="viewport"
          content="width=device-width, minimum-scale=1.0, initial-scale=1.0, user-scalable=yes">

    <link rel="stylesheet" href="stylesheets/style.css"/>
    <script src="/platform/platform.js">
    </script>
    <script src="https://cdn.socket.io/socket.io-1.0.6.js"></script>
    <link rel="import"
          href="/font-roboto/roboto.html">
    <link rel="import"
          href="/core-header-panel/core-header-panel.html">
    <link rel="import"
          href="/core-toolbar/core-toolbar.html">
    <link rel="import"
          href="/paper-tabs/paper-tabs.html">
    <link rel="import"
          href="/google-signin/google-signin.html">
    <link rel="import"
          href="/facebook-login/facebook-login.html">
    <link rel="import"
          href="/internal-signin/internal-signin.html">
</head>

<body unresolved touch-action="auto">

<core-header-panel>
    <core-toolbar>
        <paper-tabs selected="home" valueattr="name" self-end>
            <paper-tab name="home">Home</paper-tab>
        </paper-tabs>
    </core-toolbar>

    <!-- main page content will go here -->
    <div class="container card-header" layout vertical center>

        <internal-signin></internal-signin>
        <facebook-login appID="1453459064910203"></facebook-login>
        <google-signin clientId="982205522397-8maljftcknp3ofm2d0a17n4fm85c08tt.apps.googleusercontent.com" scopes="profile"></google-signin>
    </div>

    <script>
        console.log("Cr√©ation de la socket");
        var socket = io();
    </script>

</core-header-panel>

<!-- Gestion des onglets -->
<script src="/scripts/tabs.js"></script>
    <script>
    document.addEventListener("google-signin-success", function(e) {
        // Access the GAPI instance passed back from authorization
        var gapi = e.detail.gapi;

        // Load V1 of the G+ API
        gapi.client.load('plus', 'v1', function() {
            // To retreive profile information for a user, use the
            // people.get API method. For profile info for the currently
            // authorized user, use the userId value of me.
            var request = gapi.client.plus.people.get({
                'userId': 'me'
            });

            request.execute(function(resp) {
                // Some useful profile information is now available
                // via the returned object (resp). For example, we
                // can discover the displayName, skills and so on.
                console.log(resp);
                console.log("You are now signed in.");
                socket.emit("signIn", {idGPlus: resp.id});
            });
        });
        ;
    });
//10152518197570831
    document.addEventListener("facebook-signin-success", function (e) {
        console.log(e);
    });

    document.addEventListener("google-signed-out", function() {
        console.log("You are now signed out.");
    });

    document.addEventListener("google-signout-attempted", function() {
        console.log("You attempted to sign out.");
    });

    document.addEventListener("internal-signin", function(e) {
        console.log(e);
        socket.emit("signIn", {id: e.detail.id, pwd: e.detail.pwd});
    });
</script>
</body>
</html>
